<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Admission Controllers - myprep</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><li class="part-title">Overview</li><li class="chapter-item expanded "><a href="../../overview.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../../contributors.html"><strong aria-hidden="true">2.</strong> Contributors</a></li><li class="chapter-item expanded affix "><li class="part-title">Let's get started</li><li class="chapter-item expanded "><a href="../../os/os.html"><strong aria-hidden="true">3.</strong> OPERATING SYSTEM</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../os/kernel/kernel.html"><strong aria-hidden="true">3.1.</strong> Kernel</a></li><li class="chapter-item expanded "><a href="../../os/syscalls/syscalls.html"><strong aria-hidden="true">3.2.</strong> System Calls</a></li><li class="chapter-item expanded "><a href="../../os/program_process/programprocess.html"><strong aria-hidden="true">3.3.</strong> Program vs Process</a></li><li class="chapter-item expanded "><a href="../../os/threads/threads.html"><strong aria-hidden="true">3.4.</strong> Threads</a></li></ol></li><li class="chapter-item expanded "><a href="../../linux/linux.html"><strong aria-hidden="true">4.</strong> Linux</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../linux/booting/booting.html"><strong aria-hidden="true">4.1.</strong> Booting Process</a></li><li class="chapter-item expanded "><a href="../../linux/networking/networking.html"><strong aria-hidden="true">4.2.</strong> Networking</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../linux/networking/osi/osi.html"><strong aria-hidden="true">4.2.1.</strong> OSI Model</a></li><li class="chapter-item expanded "><a href="../../linux/networking/dns/dns.html"><strong aria-hidden="true">4.2.2.</strong> DNS</a></li><li class="chapter-item expanded "><a href="../../linux/networking/udp/udp.html"><strong aria-hidden="true">4.2.3.</strong> UDP</a></li><li class="chapter-item expanded "><a href="../../linux/networking/tcp/tcp.html"><strong aria-hidden="true">4.2.4.</strong> TCP</a></li><li class="chapter-item expanded "><a href="../../linux/networking/http/http.html"><strong aria-hidden="true">4.2.5.</strong> HTTP(TLS,SSL,HTTPS)</a></li><li class="chapter-item expanded "><a href="../../linux/networking/ip/ip.html"><strong aria-hidden="true">4.2.6.</strong> IPv4 vs IPv6</a></li><li class="chapter-item expanded "><a href="../../linux/networking/icmp/icmp.html"><strong aria-hidden="true">4.2.7.</strong> ICMP</a></li><li class="chapter-item expanded "><a href="../../linux/networking/troubleshooting/troubleshooting.html"><strong aria-hidden="true">4.2.8.</strong> Troubleshooting</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../linux/networking/troubleshooting/ping/ping.html"><strong aria-hidden="true">4.2.8.1.</strong> ping</a></li><li class="chapter-item expanded "><a href="../../linux/networking/troubleshooting/traceroute/traceroute.html"><strong aria-hidden="true">4.2.8.2.</strong> traceroute</a></li></ol></li></ol></li></ol></li><li class="chapter-item expanded "><li class="part-title">Intermediate</li><li class="chapter-item expanded "><a href="../../sre/sre.html"><strong aria-hidden="true">5.</strong> SRE</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../sre/tools/tools.html"><strong aria-hidden="true">5.1.</strong> Tools</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../sre/tools/virtualization/virtualization.html"><strong aria-hidden="true">5.1.1.</strong> Virtualization</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../kubernetes/k8s.html"><strong aria-hidden="true">6.</strong> Kubernetesüï∏Ô∏è</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../kubernetes/interviews/architecture.html"><strong aria-hidden="true">6.1.</strong> Architecture</a></li><li class="chapter-item expanded "><a href="../../kubernetes/interviews/kube-proxy.html"><strong aria-hidden="true">6.2.</strong> Kube-Proxy</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../kubernetes/interviews/service-coms.html"><strong aria-hidden="true">6.2.1.</strong> Service - Service Communication</a></li><li class="chapter-item expanded "><a href="../../kubernetes/interviews/admission-controllers.html" class="active"><strong aria-hidden="true">6.2.2.</strong> Admission Controllers</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../CICD/CICD.html"><strong aria-hidden="true">7.</strong> TEST</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">myprep</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/ramdevcm/mypreps" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="admission-controllers-in-kubernetes"><a class="header" href="#admission-controllers-in-kubernetes">Admission Controllers in Kubernetes</a></h1>
<p><strong>Admission Controllers</strong> are powerful extensions in Kubernetes that validate or modify incoming requests to the Kubernetes API server before they are persisted in the cluster. They provide a way to enforce security, resource management, and compliance policies by validating, mutating, or rejecting requests based on predefined rules.</p>
<p>There are two types of Admission Controllers:</p>
<ol>
<li><strong>Validating Admission Controllers</strong>: These check if the request complies with certain rules and can <strong>reject</strong> it if needed.</li>
<li><strong>Mutating Admission Controllers</strong>: These can modify the incoming request (e.g., add default values) before it is persisted.</li>
</ol>
<h2 id="scenarios-of-admission-controllers"><a class="header" href="#scenarios-of-admission-controllers">Scenarios of Admission Controllers</a></h2>
<h3 id="scenario-1-enforcing-resource-limits-for-all-pods"><a class="header" href="#scenario-1-enforcing-resource-limits-for-all-pods">Scenario 1: Enforcing Resource Limits for All Pods</a></h3>
<p><strong>Problem</strong>: You want to ensure that every Pod in the cluster has resource requests and limits (CPU and memory) set, preventing resource contention.</p>
<p><strong>Solution</strong>: Use the <code>LimitRanger</code> Admission Controller to automatically set default resource requests and limits for any Pods that do not define them.</p>
<p><strong>Action</strong>: This will ensure all Pods have proper resource requests and limits, improving resource management.</p>
<hr />
<h3 id="scenario-2-enforcing-security-context-for-all-pods"><a class="header" href="#scenario-2-enforcing-security-context-for-all-pods">Scenario 2: Enforcing Security Context for All Pods</a></h3>
<p><strong>Problem</strong>: You want to enforce that all Pods must run as non-root users to ensure security.</p>
<p><strong>Solution</strong>: Use the <code>PodSecurityPolicy</code> (or the upcoming <code>PodSecurity</code>) Admission Controller to reject Pods that run as root.</p>
<p><strong>Action</strong>: The Admission Controller ensures that Pods do not run as root by validating the <code>runAsUser</code> field and rejecting requests where it is set to root.</p>
<hr />
<h3 id="scenario-3-preventing-creation-of-dangerous-containers"><a class="header" href="#scenario-3-preventing-creation-of-dangerous-containers">Scenario 3: Preventing Creation of Dangerous Containers</a></h3>
<p><strong>Problem</strong>: You want to block Pods from using insecure or untrusted container images from public registries.</p>
<p><strong>Solution</strong>: Use a <strong>Validating Admission Controller</strong> to validate the image being used before a Pod can be created, blocking Pods that use untrusted or insecure images.</p>
<p><strong>Action</strong>: The controller checks the image name or registry and rejects the request if it matches a list of forbidden or untrusted images.</p>
<hr />
<h3 id="scenario-4-automatically-adding-labels-to-pods"><a class="header" href="#scenario-4-automatically-adding-labels-to-pods">Scenario 4: Automatically Adding Labels to Pods</a></h3>
<p><strong>Problem</strong>: You want to ensure that all Pods created in the cluster automatically receive a specific label for better organization (e.g., <code>env=production</code>).</p>
<p><strong>Solution</strong>: Use a <strong>Mutating Admission Controller</strong> to automatically add a label (<code>env=production</code>) to every Pod creation request.</p>
<p><strong>Action</strong>: The Admission Controller modifies the Pod‚Äôs metadata before it is persisted, ensuring that the label is applied.</p>
<hr />
<h3 id="scenario-5-blocking-pods-from-being-created-in-deprecated-namespaces"><a class="header" href="#scenario-5-blocking-pods-from-being-created-in-deprecated-namespaces">Scenario 5: Blocking Pods from Being Created in Deprecated Namespaces</a></h3>
<p><strong>Problem</strong>: Certain namespaces in the cluster are deprecated, and you want to prevent the creation of Pods in those namespaces.</p>
<p><strong>Solution</strong>: Use a <strong>Validating Admission Controller</strong> to reject any request to create Pods in deprecated namespaces.</p>
<p><strong>Action</strong>: The controller checks the namespace of the incoming request and denies the creation if the namespace is deprecated.</p>
<hr />
<h3 id="scenario-6-preventing-privilege-escalation-via-kubectl-exec"><a class="header" href="#scenario-6-preventing-privilege-escalation-via-kubectl-exec">Scenario 6: Preventing Privilege Escalation via kubectl Exec</a></h3>
<p><strong>Problem</strong>: You want to prevent users from escalating privileges within Pods by using <code>kubectl exec</code>.</p>
<p><strong>Solution</strong>: Use a <strong>Validating Admission Controller</strong> (such as <code>DenyEscalatingExec</code>) to block any attempt to escalate privileges via <code>kubectl exec</code>.</p>
<p><strong>Action</strong>: The controller prevents any request to run privileged commands, rejecting the request if it attempts privilege escalation.</p>
<hr />
<h3 id="scenario-7-enforcing-labeling-convention-for-resources"><a class="header" href="#scenario-7-enforcing-labeling-convention-for-resources">Scenario 7: Enforcing Labeling Convention for Resources</a></h3>
<p><strong>Problem</strong>: You want to ensure that all resources created in the cluster (e.g., Pods, Deployments) adhere to a labeling convention for organization and management.</p>
<p><strong>Solution</strong>: Use a <strong>Validating Admission Controller</strong> to validate the presence of required labels on resources.</p>
<p><strong>Action</strong>: The controller ensures that every resource created contains the required labels (e.g., <code>app</code>, <code>env</code>, <code>team</code>) and rejects any resource creation that doesn‚Äôt meet the label criteria.</p>
<hr />
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p><strong>Admission Controllers</strong> are essential in enforcing policies and managing resources within Kubernetes clusters. They help ensure security, compliance, and resource management by validating and modifying requests before they are persisted. Admission controllers can be customized to fit specific use cases, from enforcing resource limits to blocking insecure containers or ensuring labeling conventions.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../kubernetes/interviews/service-coms.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../CICD/CICD.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../kubernetes/interviews/service-coms.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../CICD/CICD.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
